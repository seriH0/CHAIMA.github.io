<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Chaima">
    <title>Marketplace</title>
    <link rel="stylesheet" href="my_style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .cart-summary {
            border: 1px solid #ccc;
            padding: 15px;
            margin-top: 10px;
            background-color: #f9f9f9;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .item-row {
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="my_vacation.html">My Dream Vacation</a></li>
            <li><a href="my_artistic_self.html">My Artistic Self</a></li>
            <li><a href="marketplace.html" class="active">Marketplace</a></li>
            <li><a href="calculators.html">Calculators</a></li>
        </ul>
    </nav>

    <div class="body_wrapper">
        <h1>Hello! This is a marketplace</h1>

        <!-- this part is for inputs -->
        <div class="item-row">
            <label>Item Name: </label>
            <input type="text" id="item_name" placeholder="e.g., pants">
        </div>
        <div class="item-row">
            <label>Price per Item ($): </label>
            <input type="number" id="item_price" placeholder="e.g., 10.05" step="0.01">
        </div>
        <div class="item-row">
            <label>Quantity: </label>
            <input type="number" id="item_quantity" placeholder="e.g., 15">
        </div>
        <button onclick="add_item_to_cart()">Add Item to Cart</button>

        <!-- button for the coat -->
        <div class="item-row" style="margin-top:10px;">
            <button onclick="add_coat()">Add 1 Coat ($99.99) to Cart</button>
        </div>

        <div id="cart_output" class="cart-summary"></div>
    </div>

    <footer>
        This website is made for CS203 labs!
    </footer>

    <script>
        function ItemGroup(name, price, quantity) {
            this.name = name;
            this.price = price;
            this.quantity = quantity;
        }

        function Cart() {
            this.itemGroups = [];
            this.log = [];

            this.log.push("1) Creating the cart\nYou have 0 item, for a total amount of 0$, in your cart!\n");

            this.addItemGroup = function(itemGroup) {
                this.itemGroups.push(itemGroup);

                const stepNumber = this.log.length + 1;
                const total = this.getTotalAmount();
                const totalWithTax = total * 1.15;

                let newStep = `${stepNumber}) Adding ${itemGroup.quantity} ${itemGroup.name} at $${itemGroup.price.toFixed(2)} each!\n`;
                newStep += `You have ${this.itemGroups.length} item(s) in your cart, for a total amount of ${total.toFixed(2)}$. With taxes, this is ${totalWithTax.toFixed(2)}$.\n`;

                this.log.push(newStep);
                this.showLog();
            }

            this.getTotalAmount = function() {
                let amount = 0;
                for (let i = 0; i < this.itemGroups.length; i++) {
                    const item = this.itemGroups[i];
                    amount += item.price * item.quantity;
                }
                return amount;
            }

            this.showLog = function() {
                document.getElementById("cart_output").innerText = this.log.join("\n");
            }
        }

        const my_cart = new Cart();
        my_cart.showLog();

        function add_item_to_cart() {
            const name = document.getElementById("item_name").value.trim();
            const price = parseFloat(document.getElementById("item_price").value);
            const quantity = parseInt(document.getElementById("item_quantity").value);

            if (!name || isNaN(price) || isNaN(quantity) || price < 0 || quantity < 1) {
                alert("Please enter valid item name, price, and quantity.");
                return;
            }

            const item = new ItemGroup(name, price, quantity);
            my_cart.addItemGroup(item);

            document.getElementById("item_name").value = "";
            document.getElementById("item_price").value = "";
            document.getElementById("item_quantity").value = "";
        }

        function add_coat() {
            const coat = new ItemGroup("coat", 99.99, 1);
            my_cart.addItemGroup(coat);
        }
    </script>
</body>
</html>
